<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¤ì†ë„ì† Â· ê²Œì‹œíŒ</title>
  <link rel="stylesheet" href="../css/home.css" />
  <style>
    *{box-sizing:border-box}
    main{max-width:1100px; margin:24px auto; padding:0 20px}

    .toolbar{display:grid; grid-template-columns:1fr auto; gap:12px; align-items:center}
    .search{display:flex; gap:8px; align-items:center; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:10px 12px}
    .search input{flex:1; background:transparent; border:0; outline:none; color:inherit}
    .filters{display:flex; gap:8px; flex-wrap:wrap}

    .chip{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; border:1px solid var(--border); background:var(--panel-2); color:var(--muted); cursor:pointer}
    .chip.active{background:linear-gradient(135deg, rgba(46,125,50,.16), rgba(167,215,181,.08)); color:var(--text)}

    .tabs{display:flex; gap:8px; flex-wrap:wrap; margin:16px 0}
    .tab{padding:10px 14px; border-radius:999px; border:1px solid var(--border); background:var(--panel-2); color:var(--muted); font-weight:600}
    .tab.active{background:linear-gradient(135deg,var(--accent),#7bbf9f); color:#0b3d2e; border-color:transparent}

    /* íƒœê·¸ í•„í„° ë°” */
    .tagbar{display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 16px}
    .tchip{padding:8px 12px; border-radius:999px; border:1px solid var(--border); background:var(--panel-2); color:var(--muted); cursor:pointer}
    .tchip.active{background:linear-gradient(135deg,var(--accent),#7bbf9f); color:#0b3d2e; border-color:transparent; font-weight:700}

    .list{display:grid; gap:16px; margin-bottom:20px}
    .item{display:grid; grid-template-columns:1fr auto; gap:12px; padding:16px; background:linear-gradient(180deg,var(--panel),var(--panel-2)); border:1px solid var(--border); border-radius:16px; box-shadow:var(--shadow)}
    .item:hover{outline:1px solid rgba(46,125,50,.25); outline-offset:2px}
    .title{font-weight:800; margin:0 0 6px}
    .meta{display:flex; gap:10px; color:var(--muted); font-size:.9rem; margin:0}
    .meta .pill{display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); background:var(--panel-2)}
    .right{display:flex; flex-direction:column; align-items:flex-end; gap:8px}
    .stats{display:flex; gap:10px; color:var(--muted)}
    .stat{display:inline-flex; align-items:center; gap:6px}

    .banner{display:flex; justify-content:space-between; align-items:center; gap:12px; padding:16px; border-radius:16px; background:linear-gradient(90deg, rgba(46,125,50,.14), rgba(167,215,181,.08)); border:1px solid var(--border); margin:14px 0}
    .banner .title{font-weight:800}

    .paging{display:flex; justify-content:center; gap:8px; margin:18px 0}
    .page{padding:8px 12px; border-radius:10px; border:1px solid var(--border); background:var(--panel-2)}
    .page.active{background:linear-gradient(135deg,var(--accent),#7bbf9f); color:#0b3d2e; border-color:transparent}

    .fab{position:fixed; right:20px; bottom:20px; padding:14px 16px; border-radius:16px; background:linear-gradient(135deg,var(--accent),#7bbf9f); color:#0b3d2e; font-weight:900; border:0; box-shadow:var(--shadow)}

    .toast{position:fixed; left:50%; transform:translateX(-50%); bottom:88px; background:var(--panel); color:var(--text); padding:10px 14px; border-radius:10px; border:1px solid var(--border); box-shadow:var(--shadow)}

    footer{max-width:1100px; margin:24px auto 40px; padding:0 20px; color:var(--muted); font-size:.9rem}
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="brand">
        <div class="brand-badge"><svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 100 18 9 9 0 000-18Zm0 3.5a1.25 1.25 0 110 2.5 1.25 1.25 0 010-2.5Zm0 4.25a.75.75 0 01.75.75v6.25a.75.75 0 01-1.5 0V11.5a.75.75 0 01.75-.75Z"/></svg></div>
        <div>ì˜¤ì†ë„ì† <span style="color:var(--muted); font-weight:600">ê²Œì‹œíŒ</span></div>
      </div>
      <div class="spacer"></div>
      <nav class="top-actions" aria-label="ìƒë‹¨ ë‚´ë¹„">
        <a class="btn" href="home.html">í™ˆ</a>
        <a class="btn" href="/stats/">í†µê³„</a>
        <a class="btn" href="/settings/">ì„¤ì •</a>
        <a class="btn btn-primary" href="/messages/thread.html">ë©”ì‹œì§€</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="toolbar">
      <label class="search" aria-label="ê²Œì‹œê¸€ ê²€ìƒ‰">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" style="opacity:.7"><path d="M10 2a8 8 0 105.293 14.293l4.707 4.707 1.414-1.414-4.707-4.707A8 8 0 0010 2zm0 2a6 6 0 110 12 6 6 0 010-12z"/></svg>
        <input placeholder="ê²€ìƒ‰: ì œëª©Â·ë‚´ìš©Â·ì‘ì„±ì" aria-label="ê²€ìƒ‰ì–´ ì…ë ¥" />
      </label>
      <div class="filters">
        <span class="chip active">ìµœì‹ ìˆœ</span>
        <span class="chip">ëŒ“ê¸€ë§ì€ìˆœ</span>
        <span class="chip">ì¢‹ì•„ìš”ìˆœ</span>
      </div>
    </div>

    <div class="tabs" role="tablist" aria-label="ì¹´í…Œê³ ë¦¬">
      <a class="tab active" href="#all">ì „ì²´</a>
      <a class="tab" href="#notice">ê³µì§€</a>
      <a class="tab" href="#life">ìƒí™œ/ì¥ë³´ê¸°</a>
      <a class="tab" href="#noise">ì†ŒìŒ/ë°°ë ¤</a>
      <a class="tab" href="#event">ì´ë²¤íŠ¸/ëª¨ì„</a>
      <a class="tab" href="#free">ììœ </a>
      <span class="spacer" style="flex:1"></span>
      <a class="tab" href="home.html#trend" title="ëŒ€ì‹œë³´ë“œ Â· ìµœê·¼ 24ì‹œê°„ ì¶”ì„¸">ì¶”ì„¸</a>
      <a class="tab" href="home.html#types" title="ëŒ€ì‹œë³´ë“œ Â· ì†Œë¦¬ ìœ í˜• TOP3">ìœ í˜•TOP3</a>
      <a class="tab" href="home.html#pattern" title="ëŒ€ì‹œë³´ë“œ Â· ë‚˜ì˜ ì†ŒìŒ íŒ¨í„´">íŒ¨í„´</a>
      <a class="tab" href="data_analysis.html#noiseChart" title="ë°ì´í„° & í†µê³„">í†µê³„</a>
    </div>

    <!-- íƒœê·¸ í•„í„° (ë™ì ) -->
    <div class="tagbar" id="tagbar" aria-label="íƒœê·¸"></div>

    <div class="banner">
      <div>
        <div class="title">ë‹¨ì–´ í•„í„°ë§ ì•ˆë‚´</div>
        <div class="sub" style="color:var(--muted)">ë¹„ì†ì–´/ë¹„ë°© í‚¤ì›Œë“œëŠ” ìë™ ì°¨ë‹¨ë©ë‹ˆë‹¤. ëª¨ë‘ê°€ í¸í•œ ì»¤ë®¤ë‹ˆí‹°ë¥¼ í•¨ê»˜ ë§Œë“¤ì–´ìš” ğŸ˜Š</div>
      </div>
      <a class="btn" href="/settings/faq.html">ìì„¸íˆ</a>
    </div>

    <div id="all" class="list" aria-label="ì „ì²´ ê²Œì‹œê¸€"></div>
    <div id="notice" class="list" aria-label="ê³µì§€" hidden></div>
    <div id="life" class="list" aria-label="ìƒí™œ/ì¥ë³´ê¸°" hidden></div>
    <div id="noise" class="list" aria-label="ì†ŒìŒ/ë°°ë ¤" hidden></div>
    <div id="event" class="list" aria-label="ì´ë²¤íŠ¸/ëª¨ì„" hidden></div>
    <div id="free" class="list" aria-label="ììœ " hidden></div>

    <div class="paging">
      <span class="page">ì´ì „</span>
      <span class="page active">1</span>
      <span class="page">2</span>
      <span class="page">3</span>
      <span class="page">ë‹¤ìŒ</span>
    </div>
  </main>

  <a class="fab" href="write.html">ğŸ“ ê¸€ì“°ê¸°</a>
  <div class="toast">ë‹¨ì–´ í•„í„°: ë¹„ì†ì–´ ìë™ ì°¨ë‹¨</div>

  <footer>
    <div>â€» ë°ì´í„° ì—°ë™ì€ ì¶”í›„ <strong>Firebase</strong> ì»¬ë ‰ì…˜(ì˜ˆ: <code>posts</code>, <code>comments</code>, <code>profiles</code>)ë¡œ êµì²´í•©ë‹ˆë‹¤. í˜„ì¬ í™”ë©´ì€ <strong>HTML/CSS/JS í”„ë¡œí† íƒ€ì…</strong>ì…ë‹ˆë‹¤.</div>
  </footer>
  <script>
    (function(){
      const sections = ['all','notice','life','noise','event','free'];
      const tabs = Array.from(document.querySelectorAll('.tabs .tab'));
      const containers = Object.fromEntries(sections.map(id => [id, document.getElementById(id)]));
      const tagbar = document.getElementById('tagbar');
      let postsCache = [];
      let currentTag = 'all'; // '#ëª¨ì„' ê°™ì€ ê°’ ë˜ëŠ” 'all'

      function createItem(post){
        const a = document.createElement('a');
        a.className = 'item';
        a.href = '/board/post.html';
        const left = document.createElement('div');
        const title = document.createElement('div');
        title.className = 'title';
        title.textContent = post.title;
        const meta = document.createElement('div');
        meta.className = 'meta';
        const pill = post.tag ? `<span class="pill">${post.tag}</span>` : '';
        meta.innerHTML = `<span>${post.author}</span><span>Â·</span><span>${post.time}</span>${pill}`;
        left.appendChild(title);
        left.appendChild(meta);

        const right = document.createElement('div');
        right.className = 'right';
        const stats = document.createElement('div');
        stats.className = 'stats';
        const cs = post.stats || {comments:0, likes:0, views:0};
        stats.innerHTML = `<span class="stat">ğŸ’¬ ${cs.comments}</span><span class="stat">ğŸ‘ ${cs.likes}</span><span class="stat">ğŸ‘€ ${cs.views}</span>`;
        right.appendChild(stats);
        if(post.tag){
          const tag = document.createElement('span');
          tag.className = 'pill';
          tag.textContent = post.tag;
          right.appendChild(tag);
        }
        a.appendChild(left);
        a.appendChild(right);
        return a;
      }

      // ì¹´í…Œê³ ë¦¬ íŒë³„ (ì œëª© ìš°ì„ , íƒœê·¸â†’ì¹´í…Œê³ ë¦¬ ë§µí•‘ ë³´ì¡°)
      function resolveCategory(post){
        const title = (post.title || '').toLowerCase();
        if(title.includes('[ê³µì§€]'.toLowerCase())) return 'notice';
        if(title.includes('[ìƒí™œ/ì¥ë³´ê¸°]'.toLowerCase())) return 'life';
        if(title.includes('[ì†ŒìŒ/ë°°ë ¤]'.toLowerCase())) return 'noise';
        if(title.includes('[ì´ë²¤íŠ¸/ëª¨ì„]'.toLowerCase())) return 'event';
        if(title.includes('[ììœ ]'.toLowerCase())) return 'free';
        const tag = (post.tag || '').replace(/\s/g,'');
        const MAP = { '#ê³µì§€':'notice','#ì ê²€':'notice', '#ëª¨ì„':'event','#ìš´ë™':'event','#ë…ì„œ':'event','#í–‰ì‚¬':'event', '#ì¥ë³´ê¸°':'life','#ë‚˜ëˆ”':'life', '#ì†ŒìŒ':'noise','#ì–‘í•´ê¸€':'noise','#ë°°ë ¤':'noise', '#ì¡ë‹´':'free','#ì‚¬ì§„':'free' };
        if(MAP[tag]) return MAP[tag];
        if(['notice','life','noise','event','free'].includes(post.category)) return post.category;
        return 'free';
      }

      // '10ë¶„ ì „' '3ì‹œê°„ ì „' 'ì–´ì œ' '2ì¼ ì „' â†’ ì •ë ¬ìš© ì ìˆ˜(ë” í° ê°’ = ë” ìµœì‹ )
      function timeScore(t){
        const s=(t||'').trim();
        if(!s) return -1e12;
        if(/^(ë°©ê¸ˆ|ì§€ê¸ˆ)$/.test(s)) return 1e12;
        if(/(\d+)\s*ë¶„ ì „/.test(s)) return 1e9 - parseInt(s)*60;
        if(/(\d+)\s*ì‹œê°„ ì „/.test(s)) return 1e8 - parseInt(s)*3600;
        if(s==='ì–´ì œ') return 1e7 - 24*3600;
        if(/(\d+)\s*ì¼ ì „/.test(s)) return 1e6 - parseInt(s)*24*3600;
        return -1e11;
      }

      function uniqueTags(posts, category){
        const set = new Set();
        posts.forEach(p=>{ if(category!=='all' && resolveCategory(p)!==category) return; if(p.tag) set.add(p.tag.trim()); });
        return ['ì „ì²´ íƒœê·¸', ...Array.from(set).sort((a,b)=>a.localeCompare(b))];
      }

      function buildTagbar(posts, category){
        if(!tagbar) return;
        const tags = uniqueTags(posts, category);
        tagbar.innerHTML='';
        tags.forEach(t=>{
          const b=document.createElement('button');
          b.type='button'; b.className='tchip'+(((currentTag==='all'&&t==='ì „ì²´ íƒœê·¸')||currentTag===t)?' active':'');
          b.textContent=t;
          b.addEventListener('click',()=>{ currentTag=(t==='ì „ì²´ íƒœê·¸')?'all':t; render(); });
          tagbar.appendChild(b);
        });
      }

      async function loadAndRender(){
        try{
          let data;
          if(location.protocol==='file:'){
            data=fallbackData; // íŒŒì¼ ì§ì ‘ ì—´ê¸° ì‹œ fetch ì œí•œ ê°€ëŠ¥
          }else{
            const res=await fetch('../../data/posts.json',{cache:'no-store'}); // C:/Users/.../making_hack/data/posts.json
            if(!res.ok) throw new Error('HTTP '+res.status);
            data=await res.json();
          }
          postsCache=Array.isArray(data.posts)?data.posts:[];
          render();
        }catch(e){
          console.error(e); postsCache=fallbackData.posts; render();
        }
      }

      function currentCategory(){
        const h=(location.hash||'#all').replace('#','');
        return sections.includes(h)?h:'all';
      }

      function render(){
        const cat=currentCategory();
        // íƒœê·¸ë°” ê°±ì‹ 
        buildTagbar(postsCache, cat);
        // ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
        sections.forEach(id=>{ if(containers[id]) containers[id].innerHTML=''; });
        // ì „ì²´: ì‹œê°„ ê¸°ì¤€ ìµœì‹ ìˆœ
        const sorted=postsCache.slice().sort((a,b)=>timeScore(b.time)-timeScore(a.time));
        sorted.forEach(p=>containers.all.appendChild(createItem(p)));

        // ì¹´í…Œê³ ë¦¬ + íƒœê·¸ í•„í„°ë§
        if(cat!=='all'){
          const list=sorted.filter(p=>resolveCategory(p)===cat)
                           .filter(p=> currentTag==='all' ? true : ((p.tag||'').trim()===currentTag));
          if(list.length===0){
            const empty=document.createElement('div');
            empty.className='item';
            empty.innerHTML='<div class="title">ì¡°ê±´ì— ë§ëŠ” ê²Œì‹œê¸€ì´ ì—†ì–´ìš”</div><div class="meta">íƒœê·¸ë¥¼ ë³€ê²½í•´ ë³´ì„¸ìš”.</div>';
            containers[cat].appendChild(empty);
          }else{
            list.forEach(p=>containers[cat].appendChild(createItem(p)));
          }
        }

        // í‘œì‹œ ì „í™˜
        sections.forEach(s=>{
          containers[s].toggleAttribute('hidden', s!==cat && s!=='all');
        });
        // íƒ­ ìƒíƒœ
        tabs.forEach(t=>t.classList.toggle('active', t.getAttribute('href')==='#'+cat));
      }

      // íƒ­ ë„¤ë¹„ê²Œì´ì…˜
      tabs.forEach(t=>t.addEventListener('click',e=>{ const href=t.getAttribute('href'); if(href&&href.startsWith('#')){ e.preventDefault(); history.pushState(null,'',href); render(); }}));
      window.addEventListener('hashchange', render);

      const fallbackData={ posts:[
        { id:'n1', title:'[ê³µì§€] ê´€ë¦¬ì‚¬ë¬´ì†Œ ì ê²€(9/15 ì›”) ì•ˆë‚´', author:'ê´€ë¦¬ì', time:'ì–´ì œ', category:'notice', tag:'#ê³µì§€', stats:{comments:3, likes:18, views:520} },
        { id:'n2', title:'[ê³µì§€] ì—˜ë¦¬ë² ì´í„° ë³´ìˆ˜ ê³µì§€ (9/12 09:30)', author:'ê´€ë¦¬ì', time:'2ì¼ ì „', category:'notice', tag:'#ì ê²€', stats:{comments:6, likes:25, views:890} },
        { id:'l1', title:'[ìƒí™œ/ì¥ë³´ê¸°] 9/12(ê¸ˆ) ì €ë… ë§ˆíŠ¸ ê°™ì´ ê°€ì‹¤ ë¶„? ğŸš—', author:'ìœ ë‚˜', time:'10ë¶„ ì „', category:'life', tag:'#ëª¨ì„', stats:{comments:12, likes:34, views:201} },
        { id:'l2', title:'[ìƒí™œ/ì¥ë³´ê¸°] ì¤‘ê³  ì•„ê¸°ì‹íƒì˜ì ë‚˜ëˆ”í•´ìš”', author:'ë‹¤ì¸', time:'1ì‹œê°„ ì „', category:'life', tag:'#ë‚˜ëˆ”', stats:{comments:9, likes:40, views:330} },
        { id:'no1', title:'[ì†ŒìŒ/ë°°ë ¤] ì˜¤ëŠ˜ 15â€“17ì‹œ ê³µì‚¬ ì†ŒìŒ ë¯¸ë¦¬ ì–‘í•´ ë¶€íƒë“œë ¤ìš”', author:'ì„±ì£¼', time:'1ì‹œê°„ ì „', category:'noise', tag:'#ì–‘í•´ê¸€', stats:{comments:8, likes:22, views:145} },
        { id:'no2', title:'[ì†ŒìŒ/ë°°ë ¤] ë°¤ 10ì‹œ ì´í›„ ì„¸íƒê¸° ì‚¬ìš© ìì œ ë¶€íƒë“œë ¤ìš”', author:'ìœ ê±´', time:'3ì‹œê°„ ì „', category:'noise', tag:'#ê³µì§€', stats:{comments:4, likes:29, views:260} },
        { id:'e1', title:'[ì´ë²¤íŠ¸/ëª¨ì„] ì¼ìš”ì¼ ì˜¤ì „ ëŸ¬ë‹ í¬ë£¨ ëª¨ì§‘í•©ë‹ˆë‹¤ ğŸƒâ€â™€ï¸', author:'ì„¸ë¯¼', time:'3ì‹œê°„ ì „', category:'event', tag:'#ìš´ë™', stats:{comments:5, likes:41, views:389} },
        { id:'e2', title:'[ì´ë²¤íŠ¸/ëª¨ì„] ë¶ì¹´í˜ì—ì„œ í† ìš” ë…ì„œëª¨ì„ í•´ìš” ğŸ“š', author:'ì§€ìˆ˜', time:'ì–´ì œ', category:'event', tag:'#ë…ì„œ', stats:{comments:11, likes:50, views:702} },
        { id:'f1', title:'[ììœ ] ë‹¨ì§€ ì• ì¹´í˜ ì‹ ë©”ë‰´ ì¶”ì²œí•´ìš” â˜•ï¸', author:'ë¡œì´', time:'ì–´ì œ', category:'free', tag:'#ì¡ë‹´', stats:{comments:14, likes:57, views:612} },
        { id:'f2', title:'[ììœ ] ë°˜ë ¤ë™ë¬¼ ì‚°ì±… ëª¨ì„ ì‚¬ì§„ ê³µìœ í•©ë‹ˆë‹¤ ğŸ¶', author:'í•˜ë¦¼', time:'2ì¼ ì „', category:'free', tag:'#ì‚¬ì§„', stats:{comments:7, likes:33, views:488} }
      ]};

      loadAndRender();
    })();
  </script>
</body>
</html>
