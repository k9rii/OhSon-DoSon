<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>오손도손 · 대시보드</title>
  <link rel="stylesheet" href="../css/home.css" />
  <style>
    /* 카드 안에 또 박스(패널)로 섹션 구획 */
    .panel{padding:16px; border:1px solid var(--border); border-radius:16px; background:var(--panel-2); box-shadow:var(--shadow-soft)}
    .panel + .panel{margin-top:14px}
    .panel h3{margin:0 0 6px; font-size:1.05rem}
    .panel .sub{margin:0 0 6px}

    /* 경고(빨간) 패널 */
    .panel-danger{background:linear-gradient(180deg, #ffe5e5, #ffecec); border-color:#ffb3b3}
    .panel-danger h3{color:#b80000}

    /* 게시판 미리보기 & 도손이 메시지 */
    .preview-list{display:grid; gap:10px}
    .preview-item{display:grid; grid-template-columns:1fr auto; align-items:center; gap:12px; padding:12px 14px; border-radius:14px; background:var(--panel); border:1px solid var(--border)}
    .preview-item:hover{outline:1px solid rgba(156,255,124,.35)}
    .preview-title{font-weight:700}
    .preview-meta{color:var(--muted); font-size:.9rem}
    .preview-tag{display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); background:rgba(255,255,255,.04); margin-left:6px}
    .preview-actions{display:flex; justify-content:flex-end; gap:10px; margin-top:12px}

    .doson{display:flex; flex-direction:column; gap:10px}
    .doson .chips{display:flex; gap:8px; flex-wrap:wrap}
    .chip-btn{padding:8px 12px; border-radius:999px; border:1px solid var(--border); background:var(--panel); color:var(--text); cursor:pointer}
    .chip-btn.active{background:linear-gradient(135deg,var(--accent),#d0ffb3); color:#0b3d2e; border-color:transparent; font-weight:800}
    .doson textarea{width:100%; min-height:96px; resize:vertical; padding:12px; border-radius:14px; border:1px solid var(--border); background:var(--panel); color:var(--text)}
    .doson .row{display:flex; gap:10px; align-items:center}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="header-inner">
        <div class="brand">
          <div class="brand-badge" aria-hidden="true">
            <svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 100 18 9 9 0 000-18Zm0 3.5a1.25 1.25 0 110 2.5 1.25 1.25 0 010-2.5Zm0 4.25a.75.75 0 01.75.75v6.25a.75.75 0 01-1.5 0V11.5a.75.75 0 01.75-.75Z"/></svg>
          </div>
          <div>오손도손 <span class="sub">대시보드</span></div>
        </div>
        <div class="spacer"></div>
        <nav class="top-actions" aria-label="상단 내비게이션">
          <a class="btn" href="board.html">게시판</a>
          <a class="btn" href="data_analysis.html">통계</a>
          <a class="btn" href="setteings.html">설정</a>
          <a class="btn btn-primary" href="/messages/thread.html">메시지</a>
        </nav>
      </div>
    </header>

    <main>
      <div class="grid">
        <!-- 메인 칼럼 -->
        <section class="card">

            <!-- [박스1] 개인화 주의 문구 전까지 (KPI + 추세 + 유형) -->
            <div class="panel">
              <div class="card-header">
                <h1>우리 집 데시벨 요약</h1>
                <p class="sub">오늘의 소음 현황과 최근 24시간 추세</p>
              </div>
              <div class="card-body">
              <div class="kpi">
                <div class="k">
                  <div class="label">현재 데시벨</div>
                  <div class="value" id="kpi-now" data-db="48">48 dB</div>
                  <div class="badge b-good">양호</div>
                </div>
                <div class="k">
                  <div class="label">오늘 최고</div>
                  <div class="value" id="kpi-peak" data-db="72">72 dB</div>
                  <div class="badge b-warn">주의 시간대 존재</div>
                </div>
                <div class="k">
                  <div class="label">야간 평균 (22–06시)</div>
                  <div class="value" id="kpi-night" data-db="42">42 dB</div>
                  <div class="badge b-good">기준치 이내</div>
                </div>
              </div>

              <div class="row" style="margin-top:14px">
                <div class="col" style="flex:1 1 420px">
                  <div id="trend" class="sub" style="margin:6px 2px 8px">최근 24시간 추세 <a href="data_analysis.html#noiseChart" style="margin-left:8px">자세히</a></div>
                  <div class="spark" aria-label="시간대별 데시벨 막대">
                    <div class="bar" style="--h:24%" data-level="good" title="00:00 · 40 dB"></div>
                    <div class="bar" style="--h:18%" data-level="good" title="01:00 · 38 dB"></div>
                    <div class="bar" style="--h:16%" data-level="good" title="02:00 · 37 dB"></div>
                    <div class="bar" style="--h:18%" data-level="good"></div>
                    <div class="bar" style="--h:22%" data-level="good"></div>
                    <div class="bar" style="--h:30%" data-level="good"></div>
                    <div class="bar" style="--h:45%" data-level="warn" title="07:00 · 통근 소음"></div>
                    <div class="bar" style="--h:55%" data-level="warn"></div>
                    <div class="bar" style="--h:42%" data-level="warn"></div>
                    <div class="bar" style="--h:36%" data-level="good"></div>
                    <div class="bar" style="--h:32%" data-level="good"></div>
                    <div class="bar" style="--h:40%" data-level="good"></div>
                    <div class="bar" style="--h:52%" data-level="warn"></div>
                    <div class="bar" style="--h:62%" data-level="warn"></div>
                    <div class="bar" style="--h:70%" data-level="bad" title="15:00 · 공사 소음"></div>
                    <div class="bar" style="--h:60%" data-level="warn"></div>
                    <div class="bar" style="--h:48%" data-level="warn"></div>
                    <div class="bar" style="--h:38%" data-level="good"></div>
                    <div class="bar" style="--h:34%" data-level="good"></div>
                    <div class="bar" style="--h:30%" data-level="good"></div>
                    <div class="bar" style="--h:26%" data-level="good"></div>
                    <div class="bar" style="--h:22%" data-level="good"></div>
                    <div class="bar" style="--h:20%" data-level="good"></div>
                    <div class="bar" style="--h:18%" data-level="good"></div>
                  </div>
                  <div class="spark-legend">
                    <span class="dot d-good"></span> 양호
                    <span class="dot d-warn" style="margin-left:10px"></span> 주의
                    <span class="dot d-bad" style="margin-left:10px"></span> 경고
                  </div>
                </div>
                <div class="col" style="flex:1 1 320px">
                  <div id="types" class="sub" style="margin:6px 2px 10px">소리 유형 TOP3 <a href="data_analysis.html#noiseChart" style="margin-left:8px">자세히</a></div>
                  <div class="hbars">
                    <div class="hbar">
                      <div class="name">말소리</div>
                      <div class="track"><div class="fill" style="--w:68%"></div></div>
                      <div class="val">68%</div>
                    </div>
                    <div class="hbar">
                      <div class="name">TV/음향</div>
                      <div class="track"><div class="fill" style="--w:54%"></div></div>
                      <div class="val">54%</div>
                    </div>
                    <div class="hbar">
                      <div class="name">가전 소음</div>
                      <div class="track"><div class="fill" style="--w:37%"></div></div>
                      <div class="val">37%</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- [박스2] 개인화 주의 문구 (빨간색) -->
            <div class="panel panel-danger">
              <h3>개인화 주의 문구</h3>
              <div class="sub">평일 오후(15–17시)에 소음이 높아지는 경향이 있어요. 이 시간대엔 TV/음향 볼륨을 한 단계 낮추거나 창문을 닫아 보세요.</div>
            </div>

            <!-- [박스3] 게시판 미리보기 -->
            <div class="panel">
              <h3>오손도손 게시판 · 미리보기</h3>
              <p class="sub">최근 업데이트 4건</p>
              <div class="preview-list">
                <a class="preview-item" href="board.html#notice">
                  <div>
                    <div class="preview-title">[공지] 관리사무소 점검 안내</div>
                    <div class="preview-meta">9/15(월) 14:00–16:00 <span class="preview-tag">#공지</span></div>
                  </div>
                  <div class="preview-meta">어제</div>
                </a>
                <a class="preview-item" href="board.html#life">
                  <div>
                    <div class="preview-title">마트 같이 가실 분? 🚗</div>
                    <div class="preview-meta">오늘 · 18:30 <span class="preview-tag">#모임</span></div>
                  </div>
                  <div class="preview-meta">10분 전</div>
                </a>
                <a class="preview-item" href="board.html#noise">
                  <div>
                    <div class="preview-title">15–17시 공사 소음 양해</div>
                    <div class="preview-meta">오늘 · 15:00 <span class="preview-tag">#양해글</span></div>
                  </div>
                  <div class="preview-meta">1시간 전</div>
                </a>
                <a class="preview-item" href="board.html#event">
                  <div>
                    <div class="preview-title">러닝 크루 모집 🏃‍♀️</div>
                    <div class="preview-meta">일요일 오전 <span class="preview-tag">#운동</span></div>
                  </div>
                  <div class="preview-meta">3시간 전</div>
                </a>
              </div>
              <div class="preview-actions">
                <a class="btn" href="board.html">전체 보기</a>
              </div>
            </div>

            <!-- [박스4] 도손이에게 메시지 보내기 -->
            <div class="panel">
              <h3>도손이에게 메시지 보내기</h3>
              <p class="sub">층간소음 관련/양해글/자유 메시지</p>
              <div class="doson">
                <div class="chips" role="group" aria-label="빠른 선택">
                  <button class="chip-btn" data-template="층간소음 상담">층간소음 상담</button>
                  <button class="chip-btn" data-template="양해글 초안">양해글 초안</button>
                  <button class="chip-btn" data-template="기타 문의">기타 문의</button>
                </div>
                <textarea id="dosonMsg" placeholder="도손이에게 보낼 내용을 입력하세요. 예: 어제 밤 11시 이후로 윗집에서 의자 끄는 소리가 반복돼요."></textarea>
                <div class="row">
                  <a class="btn" id="fillBtn">자동 완성 제안</a>
                  <a class="btn btn-primary" id="sendBtn">메시지 보내기</a>
                </div>
                <div class="sub" id="sendHint" style="display:none">메시지를 보냈어요! (프로토타입)</div>
              </div>
            </div>

            <div class="quick" style="margin-top:18px">
              <a class="qa" href="index.html">📝 양해글 쓰기</a>
              <a class="qa secondary" href="/messages/thread.html">💬 메시지 보내기</a>
              <a class="qa secondary" href="board.html">📌 오손도손 게시판</a>
            </div>
          </div>
  

        <!-- 사이드 칼럼 -->
        <aside class="side-grid">
          <section class="card">
            <div class="card-header">
              <h3>계정 & 도움말</h3>
              <p class="sub">설정 · FAQ · 관리사무소</p>
            </div>
            <div class="card-body">
              <div class="row">
                <a class="btn" href="setteings.html">프로필</a>
                <a class="btn" href="settings/faq.html">자주 묻는 질문</a>
                <a class="btn" href="setteings.html">관리사무소 연락</a>
              </div>
            </div>
          </section>
        </aside>
      </div>
    </main>

    <footer>
      <div>※ 실제 센서·차트 데이터는 추후 <strong>Firebase</strong>와 연동하여 채워질 영역입니다. 현재 화면은 <strong>HTML/CSS 프로토타입</strong>입니다.</div>
    </footer>
  </div>

  <script>
    // 도손이 메시지: 빠른 선택 & 자동완성(샘플)
    (function(){
      const chips = Array.from(document.querySelectorAll('.chip-btn'));
      const input = document.getElementById('dosonMsg');
      const fillBtn = document.getElementById('fillBtn');
      const sendBtn = document.getElementById('sendBtn');
      const hint = document.getElementById('sendHint');
      let current = '';

      const templates = {
        '층간소음 상담': '층간소음 상담을 요청합니다. 최근 일주일 중 특히 22시 이후에 의자 끄는 소리/쿵 하는 진동이 자주 납니다. 측정값과 대응 방법을 안내해 주세요.',
        '양해글 초안': '안녕하세요. 오늘(__) __시~__시 사이 집 수리에 따른 소음이 예상됩니다. 최대한 짧고 조용하게 진행하겠습니다. 양해 부탁드립니다.',
        '기타 문의': '안녕하세요. 오손도손 관련 문의가 있어 메시지 드립니다: '
      };

      chips.forEach(c=>c.addEventListener('click',()=>{
        chips.forEach(x=>x.classList.remove('active'));
        c.classList.add('active');
        current = c.dataset.template;
        input.placeholder = templates[current] || input.placeholder;
      }));

      fillBtn?.addEventListener('click',()=>{
        if(current && templates[current]) input.value = templates[current];
      });

      sendBtn?.addEventListener('click',()=>{
        // 실제 연동 시: Firebase/백엔드 POST
        hint.style.display = 'block';
        setTimeout(()=> hint.style.display='none', 2000);
        input.value='';
        chips.forEach(x=>x.classList.remove('active'));
        current='';
      });
    })();
  </script>
</body>
</html>